@echo off

set userId=%~1
set taskId=%~2
set render=%~3
set txt=%~4
set startframe=%~5
set endframe=%~6
set byframe=%~7
set proj=%~8
set mb=%~9


shift 
set renderer=%~9
set mel=c:/script/maya/maya_preRender.mel
set rd=c:/work/render/%taskId%/output/


echo task info:
	echo	userId:		%userId%
	echo	taskId:		%taskId%
	echo	render:		%render%
	echo	txt:	%txt%
	echo	startframe:	%startframe%
	echo	endframe:	%endframe%
	echo	byframe:	%byframe%
	echo	proj:	%proj%
	echo	mb:	%mb%
	echo	renderer:	%renderer%

if "%userId%"=="18305" net use W: \\10.50.1.4\dd\inputData\maya\18305\project /persistent:yes



if "%userId%"=="16630" goto render_16630
if "%renderer%"=="maxwell" goto render3
if "%renderer%"=="afterstudios" goto render_62123
if "%render%"=="C:/Program Files/Autodesk/Maya8.5/bin/Render.exe" goto render1
if "%render%"=="C:/Program Files/Autodesk/Maya2008/bin/Render.exe" goto render1
if "%render%"=="C:/Program Files/Autodesk/Maya2009/bin/Render.exe" goto render1
if "%render%"=="C:/Program Files/Autodesk/Maya2010/bin/Render.exe" goto render1
if "%render%"=="C:/Program Files/Autodesk/Maya2011/bin/Render.exe" goto render2
if "%render%"=="C:/Program Files/Autodesk/Maya2012/bin/Render.exe" goto render2
if "%render%"=="C:/Program Files/Autodesk/Maya2013/bin/Render.exe" goto render2
if "%render%"=="C:/Program Files/Autodesk/Maya2013.5/bin/Render.exe" goto render2
if "%render%"=="C:/Program Files/Autodesk/Maya2014/bin/Render.exe" goto render2


:render1
	"%render%" -s %startframe% -e %endframe% -b %byframe% -r mr -art -aml -preRender "source \"%mel%\";maya_preRender(\"%proj%\",\"%txt%\",\"%startframe%\");" -proj "%proj%" -rd %rd% "%mb%"  
	goto end

:render2
	"%render%" -s %startframe% -e %endframe% -b %byframe% -preRender "source \"%mel%\";maya_preRender(\"%proj%\",\"%txt%\",\"%startframe%\");" -proj "%proj%" -rd %rd% -mr:art -mr:aml "%mb%"  
	goto end

:render3
	"%render%" -s %startframe% -e %endframe% -b %byframe% -preRender "source \"%mel%\";maya_preRender(\"%proj%\",\"%txt%\",\"%startframe%\");" -proj "%proj%" -rd %rd% -r maxwell "%mb%"  
	goto end

:render_16630
	echo ---
	echo LWJ Configure Applied @ 16630
	echo ---
	set ts=32
	if not x%mb:_ts4_=%==x%mb% set ts=4
	if not x%mb:_ts8_=%==x%mb% set ts=8
	if not x%mb:_ts16_=%==x%mb% set ts=16
	if not x%mb:_ts24_=%==x%mb% set ts=24
	if not x%mb:_ts32_=%==x%mb% set ts=32
	if not x%mb:_ts48_=%==x%mb% set ts=48
	if not x%mb:_ts56_=%==x%mb% set ts=56

	echo	task_size:	%ts%

	net use * /delete /y
	net use Z: \\10.50.1.4\dd\inputData\maya\16630\GoolaCity /persistent:yes
	net use Y: \\10.50.1.4\dd\inputData\maya\16630\GoolaCity\VJ_Studio_Tools\2011\Y /persistent:yes
	set RENDER_ROOT=C:/Program Files/Autodesk/Maya2012/bin
	set PYTHONPATH=//10.50.1.4/dd/inputData/maya/16630/GoolaCity/VJ_Studio_Tools/scripts
	set MAYA_SCRIPT_PATH=//10.50.1.4/dd/inputData/maya/16630/GoolaCity/VJ_Studio_Tools/scripts;C:/Program Files/JoeAlter/shaveHaircut/maya2012/scripts
	set MAYA_PLUG_IN_PATH=C:/Program Files/JoeAlter/shaveHaircut/maya2012/plug-ins;C:/Program Files/3Delight/maya/plugins
	echo set MI_CUSTOM_SHADER_PATH=//10.50.1.4/dd/inputData/maya/16630/GoolaCity/VJ_Studio_Tools/shaders_p_3.3.4_maya_win64/include
	echo set MI_LIBRARY_PATH=//10.50.1.4/dd/inputData/maya/16630/GoolaCity/VJ_Studio_Tools/shaders_p_3.3.4_maya_win64/lib
	set path=//10.50.1.4/dd/inputData/maya/16630/GoolaCity/VJ_Studio_Tools/bin;%RENDER_ROOT%;%path%
	"%render%" -r mr -ts %ts% -mem 60000 -s %startframe% -e %endframe% -b %byframe% -preRender "source \"%mel%\";maya_preRender(\"%proj%\",\"%txt%\",\"%startframe%\");" -proj "%proj%" -rd %rd% -art -aml "%mb%"  
	goto end

:render_62123
echo Configure - AfterStudios
set p=%proj:\=/%
set m=%mb:\=/%

echo project____%p%
echo mb file____%m%

if "%render%"=="C:/Program Files/Autodesk/Maya2012/bin/Render.exe" goto render_62123_maya2012
if "%render%"=="C:/Program Files/Autodesk/Maya2013/bin/Render.exe" goto render_62123_maya2013
goto end

	:render_62123_maya2012
	echo render_62123_maya2012
	echo delete prefs
	rd "C:\users\enfuzion\Documents\maya\2012-x64\prefs" /s /q
	set MAYA_SCRIPT_PATH=\\10.50.1.3\pool\script\maya\nCZSupport;C:\Program Files\JoeAlter\shaveHaircut\maya2012\scripts;C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2012\scripts;\\10.50.1.4\dd\inputData\maya\62123\Support\realflow_maya_win_5.0.10\scripts\AETemplates;\\10.50.1.4\dd\inputData\maya\62123\Support\realflow_maya_win_5.0.10\scripts\others
	set MAYA_PLUG_IN_PATH=C:\Program Files\JoeAlter\shaveHaircut\maya2012\plug-ins;\\10.50.1.4\dd\inputData\maya\62123\Support\realflow_maya_win_5.0.10\bin\plug-ins
	set MI_CUSTOM_SHADER_PATH=C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2012\include;\\10.50.1.4\dd\inputData\maya\62123\Support\realflow_maya_win_5.0.10\mentalray\include
	set MI_LIBRARY_PATH=C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2012\lib;\\10.50.1.4\dd\inputData\maya\62123\Support\realflow_maya_win_5.0.10\mentalray\lib
	set XBMLANGPATH=C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2012\icons;\\10.50.1.4\dd\inputData\maya\62123\Support\realflow_maya_win_5.0.10\icons
	set RENDER_ROOT=C:\Program Files\Autodesk\Maya2012\bin
	set path=%RENDER_ROOT%;%path%
	if "%taskId%"=="1000634" goto render_62123_maya2012_hyperThread_disable
	goto render_62123_maya2012_hyperThread_enable
		:render_62123_maya2012_hyperThread_disable
		echo render_62123_maya2012_hyperThread_disable
		"%RENDER_ROOT%\render.exe" -r mr -rt 8 -aml -rnm 0 -proj %proj% -rd %rd% -s %startframe% -e %endframe% -b %byframe% -preRender "source \"%mel%\";maya_preRender(\"%proj%\",\"%txt%\",\"%startframe%\");nCMayapreRender(\"%p%\",\"%rd%\")" %m%
		goto end
		

		:render_62123_maya2012_hyperThread_enable
		echo render_62123_maya2012_hyperThread_enable
		"%RENDER_ROOT%\render.exe" -proj %proj% -rd %rd% -s %startframe% -e %endframe% -b %byframe% -mr:art -mr:aml -preRender "source \"%mel%\";maya_preRender(\"%proj%\",\"%txt%\",\"%startframe%\");nCMayapreRender(\"%p%\",\"%rd%\")" %m%
		goto end

	:render_62123_maya2013
	echo render_62123_maya2013
	echo delete prefs
	rd "C:\users\enfuzion\Documents\maya\2012-x64\prefs" /s /q
	set MAYA_SCRIPT_PATH=\\10.50.1.3\pool\script\maya\nCZSupport;C:\Program Files\JoeAlter\shaveHaircut\maya2013\scripts;C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2013\scripts;
	set MAYA_PLUG_IN_PATH=C:\Program Files\JoeAlter\shaveHaircut\maya2013\plug-ins;
	set MI_CUSTOM_SHADER_PATH=C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2013\include;
	set MI_LIBRARY_PATH=C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2013\lib;
	set XBMLANGPATH=C:\nCZ_RayWing_Extra_Addons\Shaders\shaders_p_3.3.3_maya_win64\Maya2013\icons;
	set RENDER_ROOT=C:\Program Files\Autodesk\Maya2013\bin
	set path=%RENDER_ROOT%;%path%
	"%RENDER_ROOT%\render.exe" -proj %proj% -rd %rd% -s %startframe% -e %endframe% -b %byframe% -mr:art -mr:aml -preRender "source \"%mel%\";maya_preRender(\"%proj%\",\"%txt%\",\"%startframe%\");nCMayapreRender(\"%p%\",\"%rd%\")" %m%  
	goto end

:end
echo "Rendering Completed!"